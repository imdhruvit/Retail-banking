<!DOCTYPE html>
<html>
<title>Search Customer | Retail banking</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">

<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

<link rel="stylesheet" href="css/exec.css">
<link rel="stylesheet" href="css/search_customer.css">

<style>
  body,
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    font-family: "Raleway", sans-serif
  }

  body,
  html {
    height: 100%;
    line-height: 1.8;
  }

  /* Full height image header */
  .bgimg-1 {
    background-position: center;
    background-size: cover;
    background-image: url("https://techcrunch.com/wp-content/uploads/2015/11/shutterstock_302406614.png?w=1390&crop=1");
    min-height: 100%;
  }

  .w3-bar .w3-button {
    padding: 16px;
  }
</style>

<body>
  <!-- Navbar (sit on top) -->
  <div class="w3-top" style="z-index:100">
    <div class="w3-bar w3-white w3-card" id="myNavbar">
      <a href="#home" class="w3-bar-item w3-button w3-wide">LOGO</a>
      <!-- Right-sided navbar links -->
      <div class="w3-right w3-hide-small">
        <a href="http://localhost:5000/logout" class="w3-bar-item w3-button"> LOGOUT</a>
        <a href="#about" class="w3-bar-item w3-button">ABOUT</a>
        <a href="#team" class="w3-bar-item w3-button"><i class="fa fa-user"></i> TEAM</a>
      </div>

      <!-- Hide right-floated links on small screens and replace them with a menu icon -->
      <a href="javascript:void(0)" class="w3-bar-item w3-button w3-right w3-hide-large w3-hide-medium" onclick="w3_open()">
        <i class="fa fa-bars"></i>
      </a>
    </div>
  </div>

  <!-- Sidebar on small screens when clicking the menu icon -->
  <nav class="w3-sidebar w3-bar-block w3-black w3-card w3-animate-left w3-hide-medium w3-hide-large" style="display:none" id="mySidebar">
    <a href="javascript:void(0)" onclick="w3_close()" class="w3-bar-item w3-button w3-large w3-padding-16">Close Ã—</a>

    <div class="container" style="position:relative;">
      <div class="w3l_sign_in_register category">
        <ul>
          <li><a href="http://localhost:5000/logout" data-toggle="modal" data-target="#myModal">LOGOUT</a></li>
        </ul>
      </div>
      <div>
        <a href="#about" onclick="w3_close()" class="w3-bar-item w3-button">ABOUT</a>
        <a href="#team" onclick="w3_close()" class="w3-bar-item w3-button">TEAM</a>
  </nav>

  <!-- Executive Functions -->
  <div class="container">
    <div class="row">
      <div class="col-sm-3">
        <div class="left-menu">
          <div class="logo">
            <div>Executive Functions</div>
          </div>
          <div class="accordion">
            <div class="section">
              <input type="radio" name="accordion-1" id="section-1" checked="checked" />
              <label for="section-1"><span>Manage Customer Information</span></label>
              <div class="content">
                <ul>
                  <li onclick="window.location.href='{{ url_for('create_customer') }}'"><i class="fa fa-plus"></i><span class="fn">Create New Customer</span></li>
                  <li onclick="window.location.href='{{ url_for('update_customer') }}'"><i class="fa fa-pencil-square-o"></i><span class="fn">Update Customer</span></li>
                  <li onclick="window.location.href='{{ url_for('delete_customer') }}'"><i class="fa fa-trash"></i><span class="fn">Delete Customer</span></li>
                  <li onclick="window.location.href='{{ url_for('view_cust') }}'"><i class="fa fa-list"></i><span class="fn">View Customers</span></li>
                </ul>
              </div>
            </div>
            <div class="section">
              <input type="radio" name="accordion-1" id="section-2" value="toggle" />
              <label for="section-2"> <span>Manage Account Details</span></label>
              <div class="content">
                <ul>
                  <li onclick="window.location.href='{{ url_for('create_account') }}'"><i class="fa fa-plus"></i><span class="fn">Create New Account</span></li>
                  <li onclick="window.location.href='{{ url_for('delete_account') }}'"><i class="fa fa-trash"></i><span class="fn">Delete Account</span></li>
                  <li onclick="window.location.href='{{ url_for('view_acc') }}'"><i class="fa fa-list"></i><span class="fn">View Accounts</span></li>
                </ul>
              </div>
            </div>
            <div class="section">
              <input type="radio" name="accordion-1" id="section-3" value="toggle" />
              <label for="section-3"> <span>Search Customer</span></label>
              <div class="content">
                <ul>
                  <li onclick="window.location.href='{{ url_for('search_customer') }}'"><i class="fa fa-search"></i><span class="fn">Search and View</span></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Search Customer -->
      <div class="col-sm-9" style="left:-73%;">
        <div id="content" style="margin-bottom:80px">
          <div class="login-page" id="myModal">
            <div class="form">

              <form class="login-form" id="search_customer" method="post" action="http://localhost:5000/search_customer">
                <h2 align="center" style="color:#000000 ;font-family: " Roboto", sans-serif, bold">Search Customer Details</h2>
                <p>Enter SSN ID: <input required type="text" name="id" id="id" pattern="[0-9]{9}" /></p>
                OR <br>
                <p>Enter Customer ID: <input required type="text" name="cid" id="cid" pattern="[0-9]{9}"/></p>
                <input type="submit" id="sub_form" class="submit" value="Submit">
              </form>
              <div id="result" hidden>
                <br>
                <table id="search_result">
                  <thead>
                    <tr>
                      <th>SSN ID</th>
                      <th>Customer ID</th>
                      <th>Name</th>
                      <th>Age</th>
                      <th>Address</th>
                      <th>City</th>
                      <th>State</th>
                      <th>Last Updated</th>
                    </tr>
                  </thead>

                  <tbody>
                    <col width="220">
                    <col width="220">
                    <col width="200">
                    <col width="120">
                    <col width="300">
                    <col width="300">
                    <col width="300">
                    <col width="300">
                    <tr>
                      <td id="sid"></td>
                      <td id="custid"></td>
                      <td id="cname"></td>
                      <td id="cage"></td>
                      <td id="cadd"></td>
                      <td id="ccity"></td>
                      <td id="cstate"></td>
                      <td id="clast"></td>
                    </tr>
                  </tbody>

                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    jQuery(function($) {
      var $inputs = $('input[name=id],input[name=cid]');
      $inputs.on('input', function() {
        // Set the required property of the other input to false if this input is not empty.
        $inputs.not(this).prop('required', !$(this).val().length);
      });
    });
    $('.message a').click(function() {
      $('form').animate({
        height: "toggle",
        opacity: "toggle"
      }, "slow");
    });
  </script>

  <script>
    // Modal Image Gallery
    function onClick(element) {
      document.getElementById("img01").src = element.src;
      document.getElementById("modal01").style.display = "block";
      var captionText = document.getElementById("caption");
      captionText.innerHTML = element.alt;
    }

    // Toggle between showing and hiding the sidebar when clicking the menu icon
    var mySidebar = document.getElementById("mySidebar");

    function w3_open() {
      if (mySidebar.style.display === 'block') {
        mySidebar.style.display = 'none';
      } else {
        mySidebar.style.display = 'block';
      }
    }

    // Close the sidebar with the close button
    function w3_close() {
      mySidebar.style.display = "none";
    }

    $(document).ready(function() {
      $("#sub_form").on('click', function postinput(e) {
        var sid = $('input[name=id]').val(); // this.value
        var cid = $('input[name=cid]').val();
        var ssn;
        var sel;
        if (sid) {
          ssn = sid;
          sel = 1;
        } else {
          ssn = cid;
          sel = 2;
        }
        if(sid != "" || cid != ""){
          $.ajax({
            url: "{{url_for('search_c')}}",
            data: {
              ssn: ssn,
              sel: sel
            },
            type: 'POST',
            dataType: "json"
          }).done(function(responseData) {
            if (!$.trim(responseData)) {
              alert('No records found');
              window.location.href = "http://localhost:5000/search_customer";
            } else {
            document.getElementById("sid").innerHTML = responseData[0];
            document.getElementById("custid").innerHTML = responseData[1];
            document.getElementById("cname").innerHTML = responseData[2];
            document.getElementById("cage").innerHTML = responseData[3];
            document.getElementById("cadd").innerHTML = responseData[4];
            document.getElementById("ccity").innerHTML = responseData[5];
            document.getElementById("cstate").innerHTML = responseData[6];
            document.getElementById("clast").innerHTML = responseData[7];
          }
          }).fail(function(jqXHR) {
            alert("error: " + jqXHR.status);
            console.log(jqXHR);
          });
          document.getElementById("result").hidden = false;
          e.preventDefault(e);
        }
      });
    });
  </script>

</body>

</html>
